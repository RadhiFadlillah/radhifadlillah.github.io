<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/themes/geos2/res/apple-touch-icon-144x144.png><link rel=apple-touch-icon-precomposed sizes=152x152 href=/themes/geos2/res/apple-touch-icon-152x152.png><link rel=icon type=image/png href=/themes/geos2/res/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/themes/geos2/res/favicon-16x16.png sizes=16x16><script data-goatcounter=https://radhifadlillah.goatcounter.com/count async src=//gc.zgo.at/count.js></script><link href=/themes/geos2/css/fonts.css rel=stylesheet><link href=/themes/geos2/css/index.css rel=stylesheet><title>Build Go Programs Statically - Radhi Fadlillah</title><div class=file-page><div class="window reader"><div class=window__header><p class=window__header__title>Build Go Programs Statically (10/9/20)</div><div class="window__status-bar url-trail file-page__url-trail"><a href=/ class=url-trail__item>&lt;root></a>
<a href=/blog class=url-trail__item>blog</a>
<a href=/blog/2020-09-10-build-go-statically class=url-trail__item>&lt;current-file></a></div><div class="window__content reader__content"><p>I always thought Go compiles program statically as long as we only use pure Go. So, in theory I could create an app, compile it, then run the executable binary anywhere without requiring any shared dependencies. However, several hours ago my app crashed in my server with following error :<pre><code>/usr/local/go/pkg/tool/linux_amd64/6g: /lib64/libc.so.6: version `GLIBC_2.32' not found
</code></pre><p>So, this issue is happened because my Ubuntu LTS server still uses <code>GLIBC 2.27</code> while my workstation is using rolling release distro (Manjaro) that already uses <code>GLIBC 2.32</code>. However, I was sure that my code doesn't use any cgo code, so this issue shouldn't happened.<p>After looking around, I found out that Go has two packages in the standard library that use cgo, i.e. <code>os/user</code> and <code>net</code>. To fix this, we can use <code>osusergo</code> and <code>netgo</code> build tags to skip building the cgo parts from those packages :<pre><code>go build -tags &quot;osusergo netgo&quot;
</code></pre><p>For more details you might want to check blog <a href=https://www.arp242.net/static-go.html>post</a> by <a href=https://github.com/arp242>Martin Tournoij</a> (archived locally <a href=/assets/2020-09-10-build-static-go/arp242-archive.html>here</a>). He explains in details why those packages uses cgo and how to statically link cgo package like SQLite.<div class=reader__tags><p>Tags:</p><a href=/blog/tag-golang>#golang</a>
<a href=/blog/tag-tutorial>#tutorial</a></div><div class=reader__sibling><a href=/blog/2020-09-06-calculating-prayer-times class=reader__sibling__prev>Step by Step: Calculating Prayer Times</a>
<a href=/blog/2020-09-26-new-generator-new-design class=reader__sibling__next>New Site Generator, New Site Design</a></div></div><div class=window__footer></div></div></div>